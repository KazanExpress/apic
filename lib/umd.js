!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.omnic={})}(this,function(t){"use strict";var e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};const r=Object.getOwnPropertyNames;function n(t,e,r){return t&&e?r(t,e):!t&&e?e:!e&&t?t:void 0}const o=(t,e)=>n(t,e,(t,e)=>(function(){t(...arguments),e(...arguments)})),c=(t,e)=>o(e,t),i=(t,e)=>n(t,e,(t,e)=>{const r=t=>t.match(/\/?[\w\d\.\:\@]+/g).join(""),n=t.split("//");return n.length>1?n[0]+"//"+r(n[1]+"/"+e):r(t+"/"+e)}),a=(t,r)=>n(t,r,(t,r)=>e({},t,r)),f=(t,e)=>n(t,e,(t,e)=>e),s=(t,e)=>n(t,e,(t,e)=>{const n={beforeEach:o,afterEach:c,path:i,headers:a,body:f,integrity:f,keepalive:f,referrer:f,params:f,cache:f,credentials:f,mode:f,redirect:f,referrerPolicy:f},s=r(n),u={};for(const r of s){const o=t[r],c=e[r];u[r]=n[r](o,c)}return u});function u(...t){return t.reduce(s)}const p=["GET","POST","PUT","DELETE","OPTIONS","CONNECT","TRACE","PATCH"],h=/(?:\w*:\/)?\/.*/gm,l=t=>"string"==typeof t||!!t&&y(t.valueOf)&&"string"==typeof t.valueOf(),d=t=>"[object Object]"===Object.prototype.toString.apply(t),y=t=>"function"==typeof t,m=t=>d(t)&&l(t.method)&&p.some(e=>e===t.method),O=t=>l(t)||!!t&&!d(t),E=t=>l(t)||"number"==typeof t,g=t=>{const e=t=>e=>void 0!==e?`${encodeURIComponent(t)}=${encodeURIComponent(e)}`:"";return Object.keys(t).map(r=>Array.isArray(t[r])?t[r].map(e(r)).filter(t=>t).join("&"):e(r)(t[r])).filter(t=>t).join("&")};class P{request(t,e){return[t,e]=this.processParams(t,e),console.log(t),fetch(t,e)}processParams(t,e){if(e.params){let r=g(e.params).trim();r&&(t=t+(~t.indexOf("?")?"&":"?")+r)}return[t,e]}}const T="__omnic__",b="__omnic_route__";const v=function(){try{if(isNaN.apply(null,{}))return function(t){return function(){try{return Promise.resolve(t.apply(this,arguments))}catch(t){return Promise.reject(t)}}}}catch(t){}return function(t){return function(){try{return Promise.resolve(t.apply(this,Array.prototype.slice.call(arguments)))}catch(t){return Promise.reject(t)}}}}();function j(t,e,r){return r?e?e(t):t:(t=Promise.resolve(t),e?t.then(e):t)}function C(t){const e=(e,r)=>{var n=this;if(O(e)&&(e={path:e}),y(t))return N(t,u(e,this.config));if(d(t)){if(m(t)){r&&!E(t.path)&&(t.path=r);let o=u(e,this.config,t);const c=v(function(t){O(t)&&(t={path:t}),t&&(o=u(e,n.config,t));let{path:r,beforeEach:c,afterEach:i}=o,a=function(t){const e=["body","integrity","keepalive","referrer","cache","credentials","headers","mode","redirect","referrerPolicy","method","params"],r={};for(const n of e)r[n]=t[n];return d(r.body)&&(r.body=JSON.stringify(r.body)),r}(function(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}(o,["path","beforeEach","afterEach"]));return c&&([r,a]=c(r,a)),j(n.adapter.request(r,a),function(t){let e;return function(t,e){var r=t();return r&&r.then?r.then(e):e(r)}(function(){if(i)return j(i(t),function(t){e=t});e=t},function(){return e})})});return c[T]=!0,c}return r&&!E(this.config.path)&&(this.config.path=r),function(t,e){const r={};for(const n in t)y(t[n])&&(r[n]=N(t[n],e,n));return r}(t,u(e,this.config))}return console.error("[Omnic] Error - invalid route base: ",t),t};return e[b]=!0,this.config.path&&h.test(this.config.path)?e():e}function N(t,e,r){return O(e)&&(e={path:e}),t[T]?t:t[b]?t(e,r):function(){return t(...arguments)(e,r)}}const _=(...t)=>{var e=new P,r={};t&&t.forEach(t=>{const n=typeof t;"object"===n&&void 0!==P&&t instanceof P?e=t:"object"===n?r=t:l(t)?r={path:t}:console.error("Warning! Wrong config for route:",t)});const n=C.bind({config:r,adapter:e});return n.with=_,n},A={};p.forEach(t=>{A[t]=(e=>(O(e)?e={path:e}:e||(e={}),e.method=t,_()(e)))});const S=_(),{CONNECT:w,DELETE:x,GET:I,OPTIONS:R,PATCH:U,POST:k,PUT:D,TRACE:G}=A;t.default=S,t.omnicFactory=_,t.CONNECT=w,t.DELETE=x,t.GET=I,t.OPTIONS=R,t.PATCH=U,t.POST=k,t.PUT=D,t.TRACE=G,Object.defineProperty(t,"__esModule",{value:!0})});
